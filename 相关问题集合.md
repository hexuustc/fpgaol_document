# 相关问题集合

## 内网树莓派联网方法

#### 相关链接

[Linux双网卡NAT共享上网 - 孤逐王 - 博客园 (cnblogs.com)](https://www.cnblogs.com/wonux/p/5555953.html)

#### 简述

通过配置NAT使网卡2共享网卡1的网络，从而使内网树莓派能够联网

#### 具体（以下都在主服务器中配置）

修改`/etc/sysctl.conf`文件，使`# net.ipv4.ip_forward = 0`设为 1 并取消注释

执行如下命令

```
sysctl -w net.ipv4.ip_forward=1
sysctl -p
```

再执行如下命令（**注意：其中 eth0 改为连接外网的网卡，可通过ifconfig查看**）（如二代就是enp3s4)

```
iptables -F
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE #打开NAT
```

#### 树莓派中

- 需要获得192.168.1.x的ip地址，即和主服务器一个网段

- 设置好网关：如主服务器ip为192.168.1.100，则运行如下命令

  ```sh
  sudo route add default gw 192.168.1.100 dev eth0
  ```

  可通过`netstat -r`查看

- 设置好域名解析服务器：

  需要将`/etc/resolv.conf`修改为如下代码（类似即可）

  ```
  # Generated by resolvconf
  nameserver 192.168.1.100
  nameserver 8.8.8.8
  ```

然后就可以上网啦